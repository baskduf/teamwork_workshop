# DESIGN.md

## 1) 데이터 분석

`metadata.json`은 다음 축으로 탐색되는 계층 데이터입니다.

- 공간(도면): `00(전체)` → `01(101동)`, `09(주민공동시설)`, `13(주차장)`
- 공종: 건축/구조/설비/소방 등
- 리비전: REV1, REV2, REV3 ...
- 일부 공종의 영역 분기: 예) 101동 구조 Region A/B

핵심 해석 포인트:
- 어떤 공종은 `discipline.revisions`를 바로 가짐
- 어떤 공종은 `discipline.regions[region].revisions` 형태
- 주민공동시설 건축처럼 리비전별 `imageTransform`/`polygon`이 따로 존재하는 특수 케이스가 있음

### 더 나은 데이터 표현 방법
현재도 충분히 표현력은 높지만, UI 구현 난이도를 낮추려면 아래 정규화 뷰가 유용합니다.

`viewRows[] = [{drawingId, discipline, region?, revision, image, date, description}]`

이렇게 평탄화하면 검색/정렬/비교 로직이 단순해집니다.

---

## 2) 접근 방식

1. 요구사항 핵심(탐색/표시/컨텍스트)을 먼저 만족하는 최소 프로토타입 정의
2. metadata 구조 파악 후 공통 탐색 흐름 설계
3. 1차: 단일 도면 탐색 UI 구현
4. 2차: 사용자 시나리오 대응을 위해 비교/오버레이 모드 추가
5. 제출용 문서 정리

---

## 3) UI 설계 결정

### 선택한 레이아웃
- 상단: 프로젝트 맥락
- 중단: 필터 컨트롤(공간 → 공종 → 영역 → 리비전)
- 하단: 컨텍스트 요약 + 뷰어
- 보조: 비교/오버레이 패널

선택 이유:
- 건설 실무 탐색 흐름(공간→공종→버전)과 동일한 멘탈 모델 제공
- “내가 지금 뭘 보고 있는지”를 항상 보여줘 실수 탐색 방지

### 고려했던 대안
1) 트리 네비게이션(좌측 트리)
- 장점: 전체 구조를 한눈에 보기 좋음
- 단점: 화면이 좁아지고 이미지 뷰어 집중도가 떨어짐

2) 캔버스 중심 + 컨텍스트 패널
- 장점: 전문가형 UI에 가깝고 확장성 높음
- 단점: 초기 구현 복잡도 증가

결론: 과제 시간 내에는 **필터형 탐색 + 뷰어**가 가장 안정적인 선택.

---

## 4) 기술 선택

- 상태 관리: React 기본 상태(useState/useMemo/useEffect)
  - 이유: 페이지 규모가 작고 상태 범위가 단일 화면에 한정
- 스타일: CSS 단일 파일
  - 이유: 빠른 프로토타이핑과 수정 용이성
- 빌드/개발: Vite
  - 이유: 초기 구성 단순, 빠른 개발 서버

---

## 5) 어려웠던 점 및 개선 방안

### 어려웠던 점
- 데이터 구조의 비균질성(공종마다 revisions 위치가 다름)
- imageTransform/polygonTransform을 실제 뷰어 정렬까지 반영하는 데 시간 소요 큼

### 개선 방안(시간이 더 있다면)
1. transform 엔진 적용
   - imageTransform(scale/rotation/x/y) 반영 오버레이
2. polygon 시각화
   - region 관심영역 하이라이트
3. 리비전 비교 고도화
   - before/after 슬라이더, 차이점 마스킹
4. 탐색 편의
   - 검색, 즐겨찾기, 최근 조회, 변경 이력 타임라인

---

## 6) 미해결 문제 / 시도 방법 / 대안

- 미해결: 정밀 정렬(회전/스케일 포함) 기반 오버레이
- 시도: 동일 뷰포트 단순 오버레이 + 투명도 조절
- 대안:
  - Canvas/SVG 기반 transform 렌더러 도입
  - OpenSeadragon류 타일/줌 뷰어 도입
  - 사전 정규화 스크립트로 도면별 기준 좌표계 통일
